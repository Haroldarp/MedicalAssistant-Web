<h1>Add Consultation</h1>

<form class="col-md-12" novalidate (ngSubmit)="OnSubmit()" [formGroup]="form">
    <div class="form-group col-md mx-0 px-0">
        <label class="col-md col-form-label pl-0">Title</label>
        <input type="text" class="form-control" id="title" formControlName = "title">
        <div *ngIf="form.get('title')?.dirty || form.get('title')?.touched
        || submited" 
            class="w-100 justify-content-center text-center error">
                
            <div *ngIf="form.get('title')?.errors?.required">
                Title is required
            </div>

        </div>
    </div>
    <div class="form-group col-md mx-0 px-0">
        <label class="col-md col-form-label pl-0">Description</label>
        <textarea class="form-control" rows="4" id="description" formControlName = "description"></textarea>
        <div *ngIf="form.get('description')?.dirty || form.get('description')?.touched
        || submited" 
            class="w-100 justify-content-center text-center error">
                
            <div *ngIf="form.get('description')?.errors?.required">
                Description is required
            </div>

        </div>
    </div>
    <div class="form-group col-md mx-0 px-0">
        <label class="col-md col-form-label pl-0">Patient (Id)</label>
        <input type="text" class="form-control" id="patient" formControlName = "patient"
        (keyup) = "onKeypress($event)"
        [(ngModel)]="patient" (ngModelChange)="setUserId()"
        [matAutocomplete]="auto">
        <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
            <mat-option *ngFor="let patient of filteredPatients | async" [value]="patient">
              {{patient.usuario}}
            </mat-option>
          </mat-autocomplete>
        <div *ngIf="form.get('patient')?.dirty || form.get('patient')?.touched
        || submited" 
            class="w-100 justify-content-center text-center error">
                
            <div *ngIf="form.get('patient')?.errors?.required">
                Patient name is required
            </div>

        </div>
    </div>
    <div class="form-group row col-md mx-0 px-0">
        <label class="col-md-2 col-form-label pl-0">Archive - PDF </label>
        <div class="custom-file col-md-10">
            <input type="file" class="custom-file-input" id="file" accept=".pdf" (change)="onFileChange($event)">
            <label class="custom-file-label" for="file">{{fileName}}</label>
            <div *ngIf="form.get('file')?.dirty || form.get('file')?.touched
            || submited" 
            class="w-100 justify-content-center text-center error">
                
                <div *ngIf="form.get('file')?.errors?.required">
                    File is required
                </div>

            </div>
        </div>
    </div>
    <div class="form-row mb-4 justify-content-end">
        <button type="button" class="btn btn-danger mx-3" (click)="OnCancel()">Cancel</button>
        <button type="submit" class="btn btn-primary">Save</button>
    </div>
</form>
